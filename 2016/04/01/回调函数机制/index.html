<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="回调函数机制"><meta name="keywords" content="回调,分析"><meta name="author" content="李牧羊,lin794653318@gmail.com"><meta name="copyright" content="李牧羊"><title>回调函数机制 | Atlantis</title><link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css?version=1.5.3"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  localSearch: undefined
} </script></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="https://www.tuchuang001.com/images/2018/04/27/3-15052H1035cF.jpg"></div><div class="author-info__name text-center">李牧羊</div><div class="author-info__description text-center">碌碌无为，打马而过</div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">22</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">39</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">4</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">Links</div><a class="author-info-links__name text-center" href="http://litten.me/" target="_blank">litten</a><a class="author-info-links__name text-center" href="https://developer.android.com/index.html" target="_blank">Android Developer</a><a class="author-info-links__name text-center" href="http://blog.csdn.net/wei_smile" target="_blank">CSDN</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(https://ws1.sinaimg.cn/large/8700af19ly1fnp7q2phkzj21hc0xc0yl)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Atlantis</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">主页</a><a class="site-page" href="/categories/Android/">移动开发</a><a class="site-page" href="/categories/Python/">爬虫</a><a class="site-page" href="/categories/旧事/">旧事</a><a class="site-page" href="/categories/前端开发/">前端开发</a></span></div><div id="post-info"><div id="post-title">回调函数机制</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2016-04-01</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/Android/">Android</a><span class="post-meta__separator">|</span><i class="fa fa-comment-o post-meta__icon" aria-hidden="true"></i><a href="/2016/04/01/回调函数机制/#disqus_thread"><span class="disqus-comment-count" data-disqus-identifier="2016/04/01/回调函数机制/"></span></a><div class="post-meta-wordcount"><span>字数总计: </span><span class="word-count">2,161</span><span class="post-meta__separator">|</span><span>阅读时长: 8 分钟</span></div></div></div></div><div class="layout" id="content-inner"><article id="post"><div id="post-content"><p><strong>引言</strong></p>
<blockquote>
<p>在Android的学习过程中经常会听到或者见到“回调”这个词，那么什么是回调呢？所谓的回调函数就是：<strong>在A类中定义了一个方法，这个方法中用到了一个接口和该接口中的抽象方法，但是抽象方法没有具体的实现，需要B类去实现，B类实现该方法后，它本身不会去调用该方法，而是传递给A类，供A类去调用</strong>，这种机制就称为回调。</p>
</blockquote>
<a id="more"></a>
<p>这么说可能还是有些模模糊糊，接下来我们用类比的方法一步步来看到底该怎么写一个回调函数，因为android回调中最常见的是Button的点击事件的回调，这里以此为参照：</p>
<ul>
<li>1、在A类中定义一个接口：需要我们在类中定义出一个接口，并且给这个接口定义出一个抽象方法，就像下面这样：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CallBack</span></span>&#123;</div><div class="line">		<span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span></div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<p>以下是<code>View.java</code>类中定义的响应点击事件的接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">     * Interface definition for a callback to be invoked when a view is clicked.</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OnClickListener</span> </span>&#123;</div><div class="line">        <span class="comment">/**</span></div><div class="line">         * Called when a view has been clicked.</div><div class="line">         *</div><div class="line">         * <span class="doctag">@param</span> v The view that was clicked.</div><div class="line">         */</div><div class="line">        <span class="function"><span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span></span>;</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<ul>
<li>2、在A类中定义出该接口的一个成员变量：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> CallBack mCallBack</div></pre></td></tr></table></figure>
<p>以下是<code>View.java</code>类中获取点击事件接口成员变量的源码：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">       * Listener used to dispatch click events.</div><div class="line">       * This field should be made private, so it is hidden from the SDK.</div><div class="line">       * &#123;<span class="doctag">@hide</span>&#125;</div><div class="line">       */</div><div class="line">      <span class="keyword">public</span> OnClickListener mOnClickListener;</div></pre></td></tr></table></figure></p>
<ul>
<li>3、在A类中定义出一个公共方法，可以用来设置这个接口的对象，调用该方法可以给接口对象变量赋值：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">public void setCallBack(CallBack callBack) &#123;    </div><div class="line">    this.mCallBack = callBack;    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这里看英文注释也看得出来是什么意思，是不是想到了我们平常使用<code>setOnClickListener(OnClickListener l)</code>的时候呢:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line">    * Register a callback to be invoked when this view is clicked. If this view is not</div><div class="line">    * clickable, it becomes clickable.</div><div class="line">    *</div><div class="line">    * @param l The callback that will run</div><div class="line">    *</div><div class="line">    * @see #setClickable(boolean)</div><div class="line">    */</div><div class="line">   public void setOnClickListener(@Nullable OnClickListener l) &#123;</div><div class="line">       if (!isClickable()) &#123;</div><div class="line">           setClickable(true);</div><div class="line">       &#125;</div><div class="line">       getListenerInfo().mOnClickListener = l;</div><div class="line">   &#125;</div></pre></td></tr></table></figure></p>
<p>最后一步，如果说前面的都没问题，但这一步可能更不好理解了，不过没关系，我们先看一下</p>
<ul>
<li>4、在A类中调用接口对象中的方法：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doWork</span><span class="params">()</span></span>&#123;</div><div class="line">   mCallBack.work();</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在<code>View.java</code>中的体现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line">    * Call this view's OnClickListener, if it is defined.  Performs all normal</div><div class="line">    * actions associated with clicking: reporting accessibility event, playing</div><div class="line">    * a sound, etc.</div><div class="line">    *</div><div class="line">    * <span class="doctag">@return</span> True there was an assigned OnClickListener that was called, false</div><div class="line">    *         otherwise is returned.</div><div class="line">    */</div><div class="line">   <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">performClick</span><span class="params">()</span> </span>&#123;</div><div class="line">       <span class="keyword">final</span> <span class="keyword">boolean</span> result;</div><div class="line">       <span class="keyword">final</span> ListenerInfo li = mListenerInfo;</div><div class="line">       <span class="keyword">if</span> (li != <span class="keyword">null</span> &amp;&amp; li.mOnClickListener != <span class="keyword">null</span>) &#123;</div><div class="line">           playSoundEffect(SoundEffectConstants.CLICK);</div><div class="line">           li.mOnClickListener.onClick(<span class="keyword">this</span>);<span class="comment">//就是这里</span></div><div class="line">           result = <span class="keyword">true</span>;</div><div class="line">       &#125; <span class="keyword">else</span> &#123;</div><div class="line">           result = <span class="keyword">false</span>;</div><div class="line">       &#125;</div></pre></td></tr></table></figure>
<p>这里附上整个项目的代码，这里A类映射到实际中使用<code>Employee</code> 这个类来代表：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Employee</span> </span>&#123;    </div><div class="line">    <span class="comment">/*  </span></div><div class="line">     * 定义回调接口的成员变量  </div><div class="line">     */    </div><div class="line">    <span class="keyword">private</span> CallBack mCallBack;    </div><div class="line">    <span class="comment">/*  </span></div><div class="line">     * 声明回调接口  </div><div class="line">     */    </div><div class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CallBack</span></span>&#123;    </div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span></span>;    </div><div class="line">    &#125;    </div><div class="line">    <span class="comment">/*  </span></div><div class="line">     * 设置回调接口对象成员变量  </div><div class="line">     */    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setCallBack</span><span class="params">(CallBack callBack)</span> </span>&#123;    </div><div class="line">        <span class="keyword">this</span>.mCallBack = callBack;    </div><div class="line">    &#125;    </div><div class="line">    <span class="comment">/*  </span></div><div class="line">     * 调用回调接口对象中的方法  </div><div class="line">     */    </div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doWork</span><span class="params">()</span> </span>&#123;    </div><div class="line">        mCallback.work();    </div><div class="line">    &#125;    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们在定义出一个B类，就用<code>Boss</code>类吧：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Boss</span> </span>&#123;    </div><div class="line">    <span class="keyword">private</span> Employee employee;    </div><div class="line">    <span class="comment">/*  </span></div><div class="line">     * 为Employee设置回调函数, 在这里定义具体的回调方法  </div><div class="line">     */    </div><div class="line">        employee.setCallback(<span class="keyword">new</span> Employee.Callback() &#123;    </div><div class="line">            <span class="meta">@Override</span>    </div><div class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">work</span><span class="params">()</span> </span>&#123;    </div><div class="line">                System.out.println(<span class="string">"work"</span>);    </div><div class="line">            &#125;    </div><div class="line">        &#125;);      </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>如果第一眼看不明白，我们附上我们最常用的Button点击事件的处理的代码，这里Employee 类类比一下就是<code>View</code>类：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">public class TestCallBack&#123;</div><div class="line">	private Button button;</div><div class="line">	button.setOnClickListener(new OnClickListener() &#123;</div><div class="line">		</div><div class="line">		@Override</div><div class="line">		public void onClick(View v) &#123;</div><div class="line">           //做一些操作</div><div class="line">			doWork();</div><div class="line">		&#125;</div><div class="line">	&#125;);</div><div class="line">	</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>这时候我们在再回头关于回调的定义：</strong></p>
<blockquote>
<p>在A类中定义了一个方法，这个方法中用到了一个接口和该接口中的抽象方法，但是抽象方法没有具体的实现，需要B类去实现，B类实现该方法后，它本身不会去调用该方法，而是传递给A类，供A类去调用</p>
</blockquote>
<p>这里回到我们的代码中就是：<br>我们在Employee(View)类中定义了一个接口，接口当中还含有一个抽象方法，这个抽象方法没有具体的实现，当我们需要时候自己去实现这个方法，比如这里的Boss (Button)类，这句话可能难以理解：<strong>B类实现该方法后，它本身不会去调用该方法，而是传递给A类，供A类去调用</strong>，有些人会想，诶，在<code>onClick()</code>方法中我不是写了具体的实现嘛，其实真的是这样吗，我们接着往下看，我们就来好好的分析一下这个Button点击事件。<br><strong>分析</strong><br>首先，在View类中我们能找到setOnClickListener(OnClickListener l)方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setOnClickListener</span><span class="params">(@Nullable OnClickListener l)</span> </span>&#123;</div><div class="line">       <span class="keyword">if</span> (!isClickable()) &#123;</div><div class="line">           setClickable(<span class="keyword">true</span>);</div><div class="line">       &#125;</div><div class="line">       getListenerInfo().mOnClickListener = l;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>
<p>这里将OnClickListener赋值给了mOnClickListener，我们想要找到onClick()方法是由View回调而不是Button自己回调的证据，就在这里：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">performClick</span><span class="params">()</span> </span>&#123;  </div><div class="line">     sendAccessibilityEvent(AccessibilityEvent.TYPE_VIEW_CLICKED);  </div><div class="line">     ListenerInfo li = mListenerInfo;  </div><div class="line">     <span class="keyword">if</span> (li != <span class="keyword">null</span> &amp;&amp; li.mOnClickListener != <span class="keyword">null</span>) &#123;  </div><div class="line">         playSoundEffect(SoundEffectConstants.CLICK);  </div><div class="line">         li.mOnClickListener.onClick(<span class="keyword">this</span>);  </div><div class="line">         <span class="keyword">return</span> <span class="keyword">true</span>;  </div><div class="line">     &#125;  </div><div class="line">     <span class="keyword">return</span> <span class="keyword">false</span>;  </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>对此我们的解释是：在父类中我们要用到<code>onClick()</code>方法，但是父类却没有去实现该方法，而是定义了一个方法setOnClickListener(OnClickListener l)，如果子类想要自己能够响应点击事件，则它就必须重写父类的该方法，实现OnClickListener接口和它的<code>onClick()</code>方法。在子类实现该接口和方法后，将其通过参数传递给父类，在父类中执行<code>onClick()</code>方法。那么我们是如何运行到这个<code>OnClick()</code>函数的呢，这里由于涉及到View的事件分发机制不细说，想了解的话网上有很多资料，这里只给出结论，因为我们在TestCallBack这个类中没有实现<code>OnTouchListener</code>这个接口，那么当点击事件发的时候必然会运行到<code>onTouchEvent()</code>这个方法，我们来看一下这个方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">onTouchEvent</span><span class="params">(MotionEvent event)</span> </span>&#123;  </div><div class="line">    <span class="comment">// 略去无用代码...  </span></div><div class="line">    <span class="keyword">if</span> (((viewFlags &amp; CLICKABLE) == CLICKABLE || (viewFlags &amp; LONG_CLICKABLE) == LONG_CLICKABLE)) &#123;  </div><div class="line">  </div><div class="line">         <span class="keyword">switch</span> (event.getAction()) &#123;  </div><div class="line">  </div><div class="line">              <span class="keyword">case</span> MotionEvent.ACTION_UP:  </div><div class="line">                      </div><div class="line">            <span class="comment">// 略去无用代码...  </span></div><div class="line">                <span class="keyword">if</span> (!mHasPerformedLongPress) &#123;   </div><div class="line">                    <span class="comment">// This is a tap, so remove the longpress check removeLongPressCallback();   </span></div><div class="line">                    <span class="comment">// Only perform take click actions if we were in the pressed state   </span></div><div class="line">                    <span class="keyword">if</span> (!focusTaken) &#123;   </div><div class="line">                        <span class="comment">// Use a Runnable and post this rather than calling   </span></div><div class="line">                        <span class="comment">// performClick directly. This lets other visual state   </span></div><div class="line">                        <span class="comment">// of the view update before click actions start.   </span></div><div class="line">                        <span class="keyword">if</span> (mPerformClick == <span class="keyword">null</span>) &#123;   </div><div class="line">                            mPerformClick = <span class="keyword">new</span> PerformClick();   </div><div class="line">                        &#125;   </div><div class="line">                        <span class="keyword">if</span> (!post(mPerformClick)) &#123;  </div><div class="line">                            performClick(); <span class="comment">//重点在这  </span></div><div class="line">                        &#125;   </div><div class="line">                    &#125;   </div><div class="line">                &#125;   </div><div class="line">                <span class="comment">//略去无用代码..  </span></div><div class="line">                <span class="keyword">break</span>;   </div><div class="line">        &#125;   </div><div class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;   </div><div class="line">    &#125;   </div><div class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;   </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>还记得前面我们在performClick();类里面找到的关于View.java类中对于回调方法onClick的调用么</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">li.mOnClickListener.onClick(<span class="keyword">this</span>);<span class="comment">//就是这里</span></div></pre></td></tr></table></figure>
<p>这样我们就完整的了解了整个<code>OnClickListener()</code>接口中体现出来的回调机制<br><strong>总结一下</strong><br>为了实现一个回调方法，首先要先定义一个包含了接口的类，并且这个接口中要有一个抽象方法，这个抽象方法的具体实现由其他类来完成(比如我们响应Button的点击事件，<code>onClick()</code>方法里写上当点击事件产生并且该方法被调用时候需要做的操作，比如显示一些文本信息等等)，最后该方法的回调是之前的包含有抽象方法的那个接口所在的类去调用的，比如说onClick()方法是当点击事件产生之后经过一系列的事件分发在<code>View</code>类中被调用的。这其中的奥秘就是：</p>
<blockquote>
<p><strong>回调其实是一种双向调用模式，也就说调用方在接口被调用时也会调用对方的接口，实现方法交还给提供接口的父类处理！</strong></p>
</blockquote>
<p><strong>为什么要用回调</strong></p>
<blockquote>
<p>我们都知道Java是一门面向对象的语言，有一句很著名的话就是”万事万物皆为对象”，我们把普通事物的共性抽取出来，而这些共性之中又充斥着特性，每个不同的特性就需要交给特定的情况处理，通过暴露接口方法可以减少很多重复，代码更加优雅。</p>
</blockquote>
<p>打个比方，Button、ImageButton等都具有可被点击的共性，但是被点击之后相关事件的处理是不同的，比如说我想我要点击的这个Button弹出一个消息提示，然而我希望我的ImageButton点击之后可以弹出一个Notifaction通知，这个时候回调方法的好处就体现出来了，因为android对外暴露的<code>OnClickListener()</code>接口中含有一个<code>OnClick()</code>方法，你需要怎样的具体实现都由你自己定义，而这个回调方法的所在类<code>View</code>不会管你怎么实现的，它只负责调用这个回调方法，这就是使用回调的好处。<br><strong>主要参考</strong><br><a href="http://blog.csdn.net/xsf50717/article/details/50520462" target="_blank" rel="external"> android中的回调</a><br><a href="http://blog.csdn.net/devor/article/details/17883427" target="_blank" rel="external">Android中回调函数机制解析</a></p>
</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:lin794653318@gmail.com">李牧羊</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https:///www.limuyang.cc/2016/04/01/回调函数机制/">https:///www.limuyang.cc/2016/04/01/回调函数机制/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https:///www.limuyang.cc" target="_blank">Atlantis</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/回调/">回调</a><a class="post-meta__tags" href="/tags/分析/">分析</a></div><div class="post-qr-code"><div class="post-qr-code-item"><img class="post-qr-code__img"><div class="post-qr-code__desc"></div></div></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2016/04/03/View的事件分发机制解析/"><i class="fa fa-chevron-left">  </i><span>View的事件分发机制解析</span></a></div><div class="next-post pull-right"><a href="/2016/03/01/APP启动页的正确配置方式/"><span>APP启动页的正确配置方式</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="disqus_thread"></div><script>var unused = null;
var disqus_config = function () {
  this.page.url = 'https:///www.limuyang.cc/2016/04/01/回调函数机制/';
  this.page.identifier = '2016/04/01/回调函数机制/';
  this.page.title = '回调函数机制';
}
var d = document, s = d.createElement('script');
s.src = "https://" + 'Limuyang' +".disqus.com/embed.js";
s.setAttribute('data-timestamp', '' + +new Date());
(d.head || d.body).appendChild(s);</script><script id="dsq-count-src" src="https://Limuyang.disqus.com/count.js" async></script></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2017 - 2018 By 李牧羊</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="/js/third-party/anime.min.js"></script><script src="/js/third-party/jquery.min.js"></script><script src="/js/third-party/jquery.fancybox.min.js"></script><script src="/js/third-party/velocity.min.js"></script><script src="/js/third-party/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.5.3"></script><script src="/js/fancybox.js?version=1.5.3"></script><script src="/js/sidebar.js?version=1.5.3"></script><script src="/js/copy.js?version=1.5.3"></script><script src="/js/fireworks.js?version=1.5.3"></script><script src="/js/transition.js?version=1.5.3"></script><script src="/js/scroll.js?version=1.5.3"></script><script src="/js/head.js?version=1.5.3"></script></body></html>